pipeline
{
	agent any
	
	options
	{
		skipDefaultCheckout()
		disableConcurrentBuilds()
	}

	stages
	{
		stage('Checkout Code')
		{
			steps
			{
				checkout scm
			}
		}

		stage('Build Code')
		{
			steps
			{
				build job: 'airwolf-build-job/${env.BRANCH_NAME}'
			}
		}

		stage('Test Code')
		{
			steps
			{
				sh 'mvn test'
			}
		}
	}

	post
	{
		success
		{
			script
			{
				if (env.BRANCH_NAME == 'master')
				{
					build job: 'airwolf-deploy-pipeline/master'
				}
			}
		}
	}
}